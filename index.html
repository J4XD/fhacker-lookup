<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fearless Hacker - Phone Lookup</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Share+Tech+Mono&display=swap');
    body{ background:#000;color:#00ff99;font-family:'Share Tech Mono',monospace;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:16px; }
    .card{background:rgba(10,10,10,0.94);border:1px solid #00ff99;box-shadow:0 0 20px rgba(0,255,153,0.5);padding:20px;border-radius:16px;max-width:500px;width:100%}
    .glow-text{text-shadow:0 0 10px #00ff99;font-family:'Orbitron',sans-serif;font-weight:700;}
    input{background:#111;border:1px solid #00ff99;color:#00ff99;border-radius:12px;padding:12px;font-family:'Share Tech Mono',monospace;}
    .btn-3d{background:#013015;color:#00ff99;font-weight:bold;border-radius:12px;padding:12px 16px;display:flex;align-items:center;gap:8px;}
    .row-field{background:rgba(0,50,30,0.4);padding:12px;border-radius:10px;border:1px solid rgba(0,255,153,0.3);}
    .label{font-size:12px;color:#7cffc6;text-transform:uppercase;}
    .val{font-size:16px;color:#eafff0;font-weight:700;word-break:break-word;}
  </style>
</head>
<body>
  <div class="card">
    <h1 class="text-3xl text-center glow-text mb-2">FEARLESS HACKER</h1>
    <p class="text-xs text-center text-green-400 mb-4">Phone lookup ‚Äî enter a number and press SEARCH</p>

    <div class="flex gap-2">
      <input id="num" type="text" placeholder="+919876543210" class="flex-1" />
      <button id="btn" class="btn-3d"><i class="fas fa-search"></i>SEARCH</button>
    </div>

    <div id="status" class="mt-3 text-center text-green-400 text-sm min-h-[20px]"></div>

    <div id="result" class="mt-5 hidden border border-green-500 p-4 rounded-xl">
      <strong class="block text-center text-xl glow-text border-b border-green-500 pb-2">RESULT</strong>
      <div id="fieldsArea" class="mt-3 space-y-2"></div>
    </div>
  </div>

<script>
const BASE_API = "https://shadow-x-osint.vercel.app/api?key=Shadow&type=mobile&term={NUM}";

// Primary + multiple CORS fallbacks
const PROXIES = [
  "", // direct
  "https://corsproxy.io/?",
  "https://api.allorigins.win/raw?url=",
];

function validNumber(s){ return /^\+?\d{8,15}$/.test(s.trim()); }

const numInput = document.getElementById('num');
const btn = document.getElementById('btn');
const status = document.getElementById('status');
const resultBox = document.getElementById('result');
const fieldsArea = document.getElementById('fieldsArea');

function clearDisplay(){
  fieldsArea.innerHTML = "";
  resultBox.classList.add('hidden');
}

function renderRow(label, value){
  const div = document.createElement('div');
  div.className = 'row-field';
  div.innerHTML = `<div class="label">${label}</div><div class="val">${value}</div>`;
  fieldsArea.appendChild(div);
}

// Try fetching through a list of proxies until JSON is obtained
async function fetchJSONWithFallback(rawUrl){
  let lastErr;
  for (const p of PROXIES) {
    const url = p ? (p + encodeURIComponent(rawUrl)) : rawUrl;
    try {
      const resp = await fetch(url, { headers: { "Accept": "application/json, text/plain;q=0.9,*/*;q=0.8" } });
      const ctype = resp.headers.get("content-type") || "";
      const text = await resp.text();

      // If HTML came back (starts with '<' or content-type html), skip to next proxy
      if (ctype.includes("text/html") || text.trim().startsWith("<")) {
        lastErr = new Error("Server returned HTML (likely CORS/redirect).");
        continue;
      }
      // Try parse JSON
      try {
        return JSON.parse(text);
      } catch (e) {
        // some proxies strip headers; still ensure it's valid JSON text
        if (text.trim().startsWith("{") || text.trim().startsWith("[")) {
          return JSON.parse(text);
        }
        lastErr = new Error("Not valid JSON from server.");
        continue;
      }
    } catch (e) {
      lastErr = e;
      continue;
    }
  }
  throw lastErr || new Error("Unable to fetch JSON");
}

btn.addEventListener('click', async ()=>{
  const num = numInput.value.trim();
  clearDisplay();
  status.textContent = "";

  if(!validNumber(num)){
    status.textContent = "‚ùå Invalid number format. Use with country code.";
    return;
  }

  status.textContent = "üîç Searching database...";
  btn.disabled = true;

  // Build raw API URL
  const apiUrl = BASE_API.replace("{NUM}", encodeURIComponent(num));

  try {
    const json = await fetchJSONWithFallback(apiUrl);

    // Expecting: { success: true, result: [ {...}, ... ] }
    let rows = [];
    if (json && json.success && Array.isArray(json.result)) {
      rows = json.result;
    } else if (Array.isArray(json.data)) {
      rows = json.data;
    } else if (Array.isArray(json.result?.data)) {
      rows = json.result.data;
    }

    if (!rows.length) {
      renderRow("Info", "No information found");
    } else {
      const d = rows[0];

      const fields = {
        "Mobile": d.mobile || d.phone || "",
        "Name": d.name || d.owner || "",
        "Father Name": d.father_name || "",
        "Address": (d.address || "").replace(/!/g, ", "),
        "Alternate Mobile": d.alt_mobile || "",
        "Circle": d.circle || d.carrier || "",
        "ID Number": d.id_number || d.id || "",
        "Email": d.email || ""
      };

      Object.entries(fields).forEach(([k,v]) => renderRow(k, v || "Not Available"));
    }

    resultBox.classList.remove("hidden");
    status.textContent = "";
  } catch(err){
    status.textContent = "‚ö†Ô∏è Error: " + (err.message || "Unknown error");
  } finally {
    btn.disabled = false;
  }
});
</script>
</body>
</html>